<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Maker</title>
</head>
<body id="main">
    <h1>Test maker</h1>
    <!-- -->
    <button onclick="turnmode()">turn mode</button>
    <button onclick="sensitive()">turn case</button><span id="case">case insensitive</span>
    <h3>can create the small test along your purpose</h3>
    It's maybe good to use this page to prepare for tests.
    <div name="input">
        <table border="1">
            <tr>
                <th>Questions</th> <th>Correct answer</th>
            </tr>
            <tr>
                <td><input type="text" id="q1"></td> <td><input type="text" id="c1"></td>
            </tr>
            <tr>
                <td><input type="text" id="q2"></td> <td><input type="text" id="c2"></td>
            </tr>
            <tr>
                <td><input type="text" id="q3"></td> <td><input type="text" id="c3"></td>
            </tr>
            <tr>
                <td><input type="text" id="q4"></td> <td><input type="text" id="c4"></td>
            </tr>
            <tr>
                <td><input type="text" id="q5"></td> <td><input type="text" id="c5"></td>
            </tr>
            <tr>
                <td><input type="text" id="q6"></td> <td><input type="text" id="c6"></td>
            </tr>
            <tr>
                <td><input type="text" id="q7"></td> <td><input type="text" id="c7"></td>
            </tr>
            <tr>
                <td><input type="text" id="q8"></td> <td><input type="text" id="c8"></td>
            </tr>
            <tr>
                <td><input type="text" id="q9"></td> <td><input type="text" id="c9"></td>
            </tr>
            <tr>
                <td><input type="text" id="q10"></td> <td><input type="text" id="c10"></td>
            </tr>
        </table>
        <button onclick="apply()">apply</button>
        <button onclick="save()">save</button>
        <button onclick="load()">load</button><br>
        <button onclick="fileExport()">export to device</button><br>
        inport from device<input type="file" id="inportfile">
        <span style="color:#fbfbfb" id="hiddenCode">hidden code1:Press ctrl to save.<!--I'll glad that you tell me if you find any mistakes.--></span><br>
        Scroll the page after clicking "apply" button. <span style="color:#fbfbfb" id="hiddenCode2">
            hidden code2:Enter "Example" to first Question section to load an example. <br>
            Also,
        I'm sorry if the examples are not natural.
        </span>
    </div>
    <span style="font-size:100px;"><br><br><br><br><br></span>
    <h3>The test <span style="font-weight:100;">Japanese judgement type</span></h3>
    <button onclick="loadAndApply()">load & apply</button> 
    <button onclick="apply()">apply</button>
    <input type="file"" id="inportfile2">
    <div name="test">
        <table border="1">
            <tr>
                <th>Questions</th> <th>Answer</th> <th>TF</th>
            </tr>
            <tr>
                <td id="tq1"></td> <td><input type="text" id="a1"></td> <td id="j1"></td>
            </tr>
            <tr>
                <td id="tq2"></td> <td><input type="text" id="a2"></td> <td id="j2"></td>
            </tr>
            <tr>
                <td id="tq3"></td> <td><input type="text" id="a3"></td> <td id="j3"></td>
            </tr>
            <tr>
                <td id="tq4"></td> <td><input type="text" id="a4"></td> <td id="j4"></td>
            </tr>
            <tr>
                <td id="tq5"></td> <td><input type="text" id="a5"></td> <td id="j5"></td>
            </tr>
            <tr>
                <td id="tq6"></td> <td><input type="text" id="a6"></td> <td id="j6"></td>
            </tr>
            <tr>
                <td id="tq7"></td> <td><input type="text" id="a7"></td> <td id="j7"></td>
            </tr>
            <tr>
                <td id="tq8"></td> <td><input type="text" id="a8"></td> <td id="j8"></td>
            </tr>
            <tr>
                <td id="tq9"></td> <td><input type="text" id="a9"></td> <td id="j9"></td>
            </tr>
            <tr>
                <td id="tq10"></td><td><input type="text" id="a10"></td><td id="j10"></td>
            </tr>
        </table>
        <button onclick="judge()">judge</button><span id="score"></span>
    </div>
    <script>
        let hiddenCode=document.getElementById("hiddenCode");
        let hiddenCode2=document.getElementById("hiddenCode2");
        let inportfile=document.getElementById("inportfile");
        let mode=0;
        let lettercase=0;
        let Q;
        let C;
        let TQ;
        let A;
        let J;
        function read(){
        Q=[q1,q2,q3,q4,q5,q6,q7,q8,q9,q10];
        C=[c1,c2,c3,c4,c5,c6,c7,c8,c9,c10];
        TQ=[tq1,tq2,tq3,tq4,tq5,tq6,tq7,tq8,tq9,tq10];
        A=[a1,a2,a3,a4,a5,a6,a7,a8,a9,a10];
        J=[j1,j2,j3,j4,j5,j6,j7,j8,j9,j10];
        }
        read();
        let ExQ=["加える","減算する","乗算する","Aで割る","確率","それは大部分を占める。","徐々に","以前はよく(do)していた","(doingや名詞)に慣れる","もはや"];
        let ExC=["add","subtract","multiply","divided by A","probability","It accounts for the majority.","gradually","used to do","be used to doing","no longer"];
        function apply(){
            read();
            if(Q[0].value=="Example"){
                for(let i=0;i<10;i++){
                    Q[i].value=ExQ[i];
                    C[i].value=ExC[i];
                }
            }
            for(let i=0;i<10;i++){
                TQ[i].innerHTML=Q[i].value;
            }
        }
        let saveQ;
        let saveC;
        let saveQA=[];
        let saveCA=[];

        function save(){
            read();
            for(let i=0;i<10;i++){
                saveQA.push(Q[i].value);
            }
            saveQ=JSON.stringify(saveQA);
            for(let i=0;i<10;i++){
                saveCA.push(C[i].value);
            }
            saveC=JSON.stringify(saveCA);
            localStorage.setItem("saveQ",saveQ);
            localStorage.setItem("saveC",saveC);
        }

        let loadQ=[];
        let loadC=[];

        function load(){
            read();
            loadQ=JSON.parse(localStorage.getItem("saveQ"));
            loadC=JSON.parse(localStorage.getItem("saveC"));
            for(let i=0;i<10;i++){
                Q[i].value=loadQ[i];
                C[i].value=loadC[i];
            }
           }
        let point=0;
        let maxpoints=0;
        function judge(){
            read()
            point=0;
            maxpoints=0;
            if(lettercase==0){
            for(let i=0;i<10;i++){
                if(A[i].value.toLowerCase()==C[i].value.toLowerCase()&&C[i].value){
                    J[i].innerText="O";
                    point++;
                }else if(A[i].value.toLowerCase()!=C[i].value.toLowerCase()&&C[i].value){
                    J[i].innerText="X";
                }
            }
        }else if(lettercase==1){
            for(let i=0;i<10;i++){
                if(A[i].value==C[i].value&&C[i].value){
                    J[i].innerText="O";
                    point++;
                }else if(A[i].value!=C[i].value&&C[i].value){
                    J[i].innerText="X";
                }
            }
        }
        for(let i=0;i<10;i++){
                if(C[i].value!="")maxpoints++;
            }
        document.getElementById("score").innerText="score:"+point+"/"+maxpoints;
        }
        let main=document.getElementById("main");

        function lightmode(){
            //turn mode into default
            main.style.color="";
            main.style.backgroundColor="";
            hiddenCode.style.color="#fbfbfb";
            hiddenCode2.style.color="#fbfbfb";
            mode=0;
            for(let i=0;i<10;i++){
                Q[i].style.color="";
                Q[i].style.backgroundColor="";
                C[i].style.color="";
                C[i].style.backgroundColor="";
                A[i].style.color="";
                A[i].style.backgroundColor="";
            }
        }
        function darkmode(){
            main.style.color="#fff";
            main.style.backgroundColor="#222";
            hiddenCode.style.color="#2b2b2b";
            hiddenCode2.style.color="#2b2b2b";
            mode=1;
            for(let i=0;i<10;i++){
                Q[i].style.color="#fff";
                Q[i].style.backgroundColor="#999";
                C[i].style.color="#fff";
                C[i].style.backgroundColor="#999";
                A[i].style.color="#fff";
                A[i].style.backgroundColor="#999";
            }
        }
        /* template
            main.style.color="#";
            main.style.backgroundColor="#";
            hiddenCode.style.color="#";
            hiddenCode2.style.color="#";
            mode=2;
            for(let i=0;i<10;i++){
                Q[i].style.color="#";
                Q[i].style.backgroundColor="#";
                C[i].style.color="#";
                C[i].style.backgroundColor="#";
                A[i].style.color="#";
                A[i].style.backgroundColor="#";
            }
            localStorage.setItem("mode",mode);
                */
        function turnmode(){
            if(mode==0){
                darkmode();
            }else{
                lightmode();
            }
            localStorage.setItem("mode",mode);
        }
        function loadAndApply(){
            load();
            apply();
        }
        if(localStorage.getItem("mode"))mode=parseFloat(localStorage.getItem("mode"));
            if(mode==0)lightmode();
            else if(mode==1)darkmode();
            document.addEventListener("keydown", (e)=>{
            let key=e.keyCode;
            if(key==17)save();
            if(key==13)judge();
        });
        let sensitiveCase=()=>{
            lettercase=1;
            document.getElementById("case").innerText="case sensitive";
        }
        let insensitiveCase=()=>{
            lettercase=0;
            document.getElementById("case").innerText="case insensitive";
        }
        function sensitive(){
            if(lettercase==0){
                sensitiveCase();
            }else if(lettercase==1){
                insensitiveCase();
            }
            localStorage.setItem("case",lettercase);
        }
        if(localStorage.getItem("case"))lettercase=parseFloat(localStorage.getItem("case"));
        if(lettercase==0)insensitiveCase();
        else if(lettercase==1)sensitiveCase();
        let inportdata;
        let exportdata=[[],[]];
        function fileExport(){
            for(let i=0;i<10;i++){
                exportdata[0].push(Q[i].value);
                exportdata[1].push(C[i].value);
            }
            const blob=new Blob([JSON.stringify(exportdata)],{type:"text/planin"});
            const link=document.createElement("a");
            link.href=URL.createObjectURL(blob);
            link.download="madetest.txt";
            link.click();
        }
        inportfile.addEventListener("change",(e)=>{
            const file=e.target.files[0];
            const reader=new FileReader();
            reader.onload=()=>{
                inportdata=JSON.parse(reader.result);
                for(let i=0;i<10;i++){
                    loadQ[i]=inportdata[0][i];
                    loadC[i]=inportdata[1][i];
                }
                read();
                for(let i=0;i<10;i++){
                    Q[i].value=loadQ[i];
                    C[i].value=loadC[i];
                }
            };
            reader.readAsText(file);
        });
        let inportfile2=document.getElementById("inportfile2");
        inportfile2.addEventListener("change",(e)=>{
            const file=e.target.files[0];
            const reader=new FileReader();
            reader.onload=()=>{
                inportdata=JSON.parse(reader.result);
                for(let i=0;i<10;i++){
                    loadQ[i]=inportdata[0][i];
                    loadC[i]=inportdata[1][i];
                }
                read();
                for(let i=0;i<10;i++){
                    Q[i].value=loadQ[i];
                    C[i].value=loadC[i];
                }
                apply();
            };
            reader.readAsText(file);
        });
    </script>
</body>
</html>
